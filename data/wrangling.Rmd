---
title: "Data Wrangling"
author: "Jill Cates"
date: '2018-01-14'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(lubridate)
library(forcats)
```


```{r}
data <- read_csv('data.csv')
```



```{r}
data <- data %>% 
  select('Unique Key', 'Created Date', 'Closed Date', 'Agency', 'Complaint Type', 'Location Type', 'Borough', 'Incident Address', 'Latitude', 'Longitude')

colnames(data) <- c('id', 'created_date', 'closed_date', 'agency', 'complaint_type', 'location_type', 'borough', 'incident_address', 'lat', 'long')

data$closed_date <- parse_date_time(data$closed_date, "%m/%d/%Y $I:%M:%S %p", tz = "EST5EDT")

data$created_date <- parse_date_time(data$created_date, "%m/%d/%Y %I:%M:%S %p", tz = "EST5EDT")


```



```{r}
# data <- data[data$created_date >= "2016-01-01" & data$created_date <= "2016-12-31", ]

data$borough <- data$borough %>%
  fct_recode("Brooklyn" = "BROOKLYN", "Queens" = "QUEENS", "Manhattan" = "MANHATTAN", "Staten Island" = "STATEN ISLAND", "Bronx" = "BRONX")

data <- data %>% 
  filter(borough != 'Unspecified')
data$borough <- as.factor(data$borough)

data$month_created <- month(data$created_date)
data$year_created <- year(data$created_date)
data$day_created <- day(data$created_date)
data$hour_created <- hour(data$created_date)

data$month_closed <- month(data$closed_date)
data$year_closed <- year(data$closed_date)
data$day_closed <- day(data$closed_date)


write_csv(data, 'data_wrangled.csv')
```




